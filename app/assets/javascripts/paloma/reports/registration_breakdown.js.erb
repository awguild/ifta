(function(){
  // You access variables from before/around filters from _x object.
  // You can also share variables to after/around filters through _x object.
  var _x = Paloma.variableContainer;

  // We are using _L as an alias for the locals container.
  // Use either of the two to access locals from other scopes.
  //
  // Example:
  // _L.otherController.localVariable = 100;
  var _L = Paloma.locals;

  // Access locals for the current scope through the _l object.
  //
  // Example:
  // _l.localMethod(); 
  var _l = _L['reports'];


  Paloma.callbacks['reports']['registration_breakdown'] = function(params){
      var plotData = function(report_data){
        var plot1 = jQuery.jqplot ('chart1', [report_data], 
          { 
            seriesDefaults: {
              // Make this a pie chart.
              renderer: jQuery.jqplot.PieRenderer, 
              rendererOptions: {
                // Put data labels on the pie slices.
                // By default, labels show the percentage of the slice.
                showDataLabels: true,
                dataLabels: 'value'
              }
            }, 
            legend: { show:true, location: 'e' }
          }
      );
    };
    var url = $('#report_data_url').data('url');
    $.get(url, function(response){
      plotData(response);
      console.log(response);
    });
  };

})();